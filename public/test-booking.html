<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Custom Booking Form</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .form-container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        .form-group {
            margin-bottom: 15px;
        }
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
            color: #333;
        }
        input, select, textarea {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 14px;
        }
        button {
            background: linear-gradient(45deg, #FFD700, #FFA500);
            color: black;
            padding: 12px 30px;
            border: none;
            border-radius: 5px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            width: 100%;
            margin-top: 20px;
        }
        button:hover {
            background: linear-gradient(45deg, #FFA500, #FFD700);
        }
        .result {
            margin-top: 20px;
            padding: 15px;
            border-radius: 5px;
            display: none;
        }
        .success {
            background: #d4edda;
            border: 1px solid #c3e6cb;
            color: #155724;
        }
        .error {
            background: #f8d7da;
            border: 1px solid #f5c6cb;
            color: #721c24;
        }
        .row {
            display: flex;
            gap: 15px;
        }
        .col {
            flex: 1;
        }
    </style>
</head>
<body>
    <div class="form-container">
        <h1>üß™ ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á Custom Booking</h1>
        <p>‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏ô‡∏µ‡πâ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡πÇ‡∏î‡∏¢‡∏ï‡∏£‡∏á‡πÑ‡∏õ‡∏¢‡∏±‡∏á API endpoint</p>
        
        <form id="customBookingForm">
            <div class="row">
                <div class="col">
                    <div class="form-group">
                        <label for="destination">‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏® *</label>
                        <select id="destination" name="destination" required>
                            <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®</option>
                            <option value="‡∏ç‡∏µ‡πà‡∏õ‡∏∏‡πà‡∏ô">‡∏ç‡∏µ‡πà‡∏õ‡∏∏‡πà‡∏ô</option>
                            <option value="‡πÄ‡∏Å‡∏≤‡∏´‡∏•‡∏µ‡πÉ‡∏ï‡πâ">‡πÄ‡∏Å‡∏≤‡∏´‡∏•‡∏µ‡πÉ‡∏ï‡πâ</option>
                            <option value="‡πÑ‡∏ï‡πâ‡∏´‡∏ß‡∏±‡∏ô">‡πÑ‡∏ï‡πâ‡∏´‡∏ß‡∏±‡∏ô</option>
                            <option value="‡∏™‡∏¥‡∏á‡∏Ñ‡πÇ‡∏õ‡∏£‡πå">‡∏™‡∏¥‡∏á‡∏Ñ‡πÇ‡∏õ‡∏£‡πå</option>
                            <option value="‡∏°‡∏≤‡πÄ‡∏•‡πÄ‡∏ã‡∏µ‡∏¢">‡∏°‡∏≤‡πÄ‡∏•‡πÄ‡∏ã‡∏µ‡∏¢</option>
                        </select>
                    </div>
                </div>
                <div class="col">
                    <div class="form-group">
                        <label for="city">‡πÄ‡∏°‡∏∑‡∏≠‡∏á *</label>
                        <input type="text" id="city" name="city" placeholder="‡πÄ‡∏ä‡πà‡∏ô Tokyo, Seoul" required>
                    </div>
                </div>
            </div>

            <div class="row">
                <div class="col">
                    <div class="form-group">
                        <label for="startDate">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏¥‡πà‡∏° *</label>
                        <input type="date" id="startDate" name="startDate" required>
                    </div>
                </div>
                <div class="col">
                    <div class="form-group">
                        <label for="endDate">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏¥‡πâ‡∏ô‡∏™‡∏∏‡∏î *</label>
                        <input type="date" id="endDate" name="endDate" required>
                    </div>
                </div>
            </div>

            <div class="row">
                <div class="col">
                    <div class="form-group">
                        <label for="numberOfPeople">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ñ‡∏ô *</label>
                        <input type="number" id="numberOfPeople" name="numberOfPeople" min="1" max="50" value="2" required>
                    </div>
                </div>
                <div class="col">
                    <div class="form-group">
                        <label for="budget">‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì (‡∏ö‡∏≤‡∏ó) *</label>
                        <input type="number" id="budget" name="budget" min="1000" step="1000" placeholder="‡πÄ‡∏ä‡πà‡∏ô 100000" required>
                    </div>
                </div>
            </div>

            <div class="form-group">
                <label for="contactName">‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏• *</label>
                <input type="text" id="contactName" name="contactName" placeholder="‡∏ä‡∏∑‡πà‡∏≠ ‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•" required>
            </div>

            <div class="row">
                <div class="col">
                    <div class="form-group">
                        <label for="contactEmail">‡∏≠‡∏µ‡πÄ‡∏°‡∏• *</label>
                        <input type="email" id="contactEmail" name="contactEmail" placeholder="example@email.com" required>
                    </div>
                </div>
                <div class="col">
                    <div class="form-group">
                        <label for="contactPhone">‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå *</label>
                        <input type="tel" id="contactPhone" name="contactPhone" placeholder="0812345678" required>
                    </div>
                </div>
            </div>

            <div class="form-group">
                <label for="tripType">‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏ó‡∏£‡∏¥‡∏õ</label>
                <select id="tripType" name="tripType">
                    <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏ó‡∏£‡∏¥‡∏õ</option>
                    <option value="honeymoon">‡∏Æ‡∏±‡∏ô‡∏ô‡∏µ‡∏°‡∏π‡∏ô</option>
                    <option value="family">‡∏Ñ‡∏£‡∏≠‡∏ö‡∏Ñ‡∏£‡∏±‡∏ß</option>
                    <option value="adventure">‡∏ú‡∏à‡∏ç‡∏†‡∏±‡∏¢</option>
                    <option value="cultural">‡∏ß‡∏±‡∏í‡∏ô‡∏ò‡∏£‡∏£‡∏°</option>
                    <option value="beach">‡∏ó‡∏∞‡πÄ‡∏•-‡∏ä‡∏≤‡∏¢‡∏´‡∏≤‡∏î</option>
                    <option value="shopping">‡∏ä‡πâ‡∏≠‡∏õ‡∏õ‡∏¥‡πâ‡∏á</option>
                    <option value="business">‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à</option>
                    <option value="relaxation">‡∏û‡∏±‡∏Å‡∏ú‡πà‡∏≠‡∏ô</option>
                </select>
            </div>

            <div class="form-group">
                <label for="description">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°</label>
                <textarea id="description" name="description" rows="3" placeholder="‡∏ö‡∏≠‡∏Å‡πÄ‡∏£‡∏≤‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡∏ó‡∏£‡∏¥‡∏õ‡πÉ‡∏ô‡∏ù‡∏±‡∏ô..."></textarea>
            </div>

            <button type="submit">‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡πÄ‡∏™‡∏ô‡∏≠‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á</button>
        </form>

        <div id="result" class="result"></div>
    </div>

    <script>
        // Set minimum date to today
        const today = new Date().toISOString().split('T')[0];
        document.getElementById('startDate').min = today;
        document.getElementById('endDate').min = today;

        // Update end date minimum when start date changes
        document.getElementById('startDate').addEventListener('change', function() {
            document.getElementById('endDate').min = this.value;
        });

        document.getElementById('customBookingForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const resultDiv = document.getElementById('result');
            resultDiv.style.display = 'none';
            
            // Collect form data
            const formData = new FormData(this);
            const data = {};
            for (let [key, value] of formData.entries()) {
                data[key] = value;
            }
            
            // Format destination
            data.destination = `${data.destination} ${data.city}`;
            delete data.city;
            
            // Convert numbers
            data.numberOfPeople = parseInt(data.numberOfPeople);
            data.budget = parseFloat(data.budget);
            
            // Add required fields
            data.proposalType = 'custom_booking';
            
            console.log('Sending data:', data);
            
            try {
                const response = await fetch('http://localhost:3002/api/custom-bookings', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(data)
                });
                
                const result = await response.json();
                
                resultDiv.style.display = 'block';
                
                if (response.ok && result.success) {
                    resultDiv.className = 'result success';
                    resultDiv.innerHTML = `
                        <h3>‚úÖ ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!</h3>
                        <p><strong>ID:</strong> ${result.data.customBookingId}</p>
                        <p><strong>‡∏õ‡∏•‡∏≤‡∏¢‡∏ó‡∏≤‡∏á:</strong> ${result.data.destination}</p>
                        <p><strong>‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì:</strong> ‡∏ø${result.data.budget.toLocaleString()}</p>
                        <p><strong>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞:</strong> ${result.data.status}</p>
                    `;
                } else {
                    resultDiv.className = 'result error';
                    resultDiv.innerHTML = `
                        <h3>‚ùå ‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î</h3>
                        <p>${result.error || result.message || '‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏ó‡∏£‡∏≤‡∏ö‡∏™‡∏≤‡πÄ‡∏´‡∏ï‡∏∏'}</p>
                    `;
                }
            } catch (error) {
                resultDiv.style.display = 'block';
                resultDiv.className = 'result error';
                resultDiv.innerHTML = `
                    <h3>‚ùå ‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠</h3>
                    <p>${error.message}</p>
                `;
            }
        });
    </script>
</body>
</html>
